#pragma once

#define ROOT_CERT_TAG 1
#define CLIENT_CERT_TAG 2

#define CLIENT_CERT 1

/**
 * The inc files are generated by Zephyr in .pio/<board
 * name>/zephyr/include/generated and are referenced in the platformio.ini file.
 *
 * A quick note on certificate formats:
 * Zephyr and mbedtls in its current form is *extremely* picky on the formats
 * for keys and certificates. If mbedtls runs out of heap while parsing the
 * keys it will report an error indicating invalid key format (which is...
 * confusing).
 * The Ed25519 algorithm isn't supported for signatures. The 25519 curve *is*
 * supported in mbedtls but only for encryption, not for signatures. The P256
 * curves are supported out of the box so it's a decent middle ground between
 * key size and strength (with RSA-2048 on one side and Ed25519 on the other
 * side)
 */
static const unsigned char client_certificate[] = {
#include "client.der.inc"
};

static const unsigned char client_key[] = {
#include "client_key.der.inc"
};

// This will only include the root certificate and not the intermediates
static const unsigned char root_certificate[] = {
#include "lab5e_ca.der.inc"
};
